<div class="panel panel-primary">
  <div class="panel-heading">
    <div ng-if="mode=='them'" class="panel-title">{{"them_tin_moi"|translate}}</div>
    <div ng-if="mode=='sua'" class="panel-title">{{"cap_nhat_tin_moi"|translate}}</div>
  </div>

  <div class="panel-body">
    <form class="form-horizontal form margin-bottom-40" role="form" id="form-tin-moi" mode="{{mode}}">
      <div class="form-heading text-center">
        <button class="btn btn-success" ng-if="mode=='them'"> <i class="fa fa-plus"> </i> {{"them"|translate}}</button>
        <button class="btn btn-success" ng-if="mode=='sua'"> <i class="fa fa-plus"> </i> {{"luu"|translate}}</button>
        <div class="btn btn-danger" ng-click="goToList()">
          <i class="fa fa-close"> </i> {{"huy"|translate}}
        </div>
      </div>
      <div class="form-body">
        <div class="col-md-12">
          <div class="row">
            <div class="col-md-6">
              <div class="form-group form-md-line-input">
                <label class="col-md-4 control-label text-right">{{"loai_tin"|translate}}</label>
                <div class="col-md-8">
                  <select class="form-control" name="type" convert-number ng-model="data.type">
                    <option value="0" ng-selected="data.type==0">{{"dich_vu"|translate}}</option>
                    <option value="1" ng-selected="data.type==1">{{"khuyen_mai"|translate}}</option>
                    <option value="2" ng-selected="data.type==2">{{"tin_tuc"|translate}}</option>
                  </select>
                  <div class="form-control-focus"> </div>
                </div>
              </div>
            </div>
            <div class="col-md-6">
              <div class="form-group form-md-line-input" ng-if="data.type==0">
                <label class="col-md-4 control-label text-right">{{"dich_vu"|translate}}</label>
                <div class="col-md-8">
                  <select select2 class="form-control" name="id" refresh-counter="serviceRefresh" get-data="getServices()" ng-model="data.id"> </select>
                  <div class="form-control-focus"> </div>
                </div>
              </div>
              <div class="form-group form-md-line-input" ng-if="data.type==1">
                <label class="col-md-4 control-label text-right">{{"khuyen_mai"|translate}}</label>
                <div class="col-md-8">
                  <select select2 class="form-control" name="id" refresh-counter="promotionRefresh" get-data="getPromotions()" ng-model="data.id"> </select>
                  <div class="form-control-focus"> </div>
                </div>
              </div>
              <div class="form-group form-md-line-input" ng-if="data.type==2">
                <label class="col-md-4 control-label text-right">{{"tin_tuc"|translate}}</label>
                <div class="col-md-8">
                  <select select2 class="form-control" name="id" refresh-counter="newsRefresh" get-data="getNews()" ng-model="data.id"> </select>
                  <div class="form-control-focus"> </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-6">
              <div class="form-group form-md-line-input">
                <label class="col-md-4 control-label text-right">{{"thu_tu_uu_tien"|translate}}</label>
                <div class="col-md-8">
                  <input type="text" class="form-control" name="priority" ng-model="data.priority" />
                  <div class="form-control-focus"> </div>
                </div>
              </div>
            </div>
            <div class="col-md-6" style="padding-top:15px">
              <div radio-language ng-model="data.language" name="language"> </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="col-md-6">
                <div class="form-group form-md-line-input">
                  <label class="col-md-4 control-label text-left">{{"ngay_hieu_luc"|translate}}</label>
                  <div class="col-md-8">
                    <div datepicker ng-model="data.effectTime" name="effectTime" id="effectTime" class="input-group date  bs-datetime"> </div>
                  </div>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-group form-md-line-input">
                  <label class="col-md-4 control-label text-left">{{"ngay_het_hieu_luc"|translate}}</label>
                  <div class="col-md-8">
                    <div datepicker ng-model="data.expiredTime" name="expiredTime" id="expiredTime" class="input-group date  bs-datetime"> </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="row">
            <div class="col-md-12">
              <div class="form-group form-md-line-input">
                <label class="col-md-2 control-label text-left">{{"anh_mo_ta"|translate}}</label>
                <div class="col-md-10">
                  <div fileinput class="fileinput" mode="{{mode}}" folder="hotnews" ng-model="data.adImgUrl" name="adImgUrl" data-provides="fileinput" ng-class="{'fileinput-new': mode=='them','fileinput-exists':mode=='sua'}">
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="form-group form-md-line-input">
                <label class="col-md-2 control-label text-left">{{"trang_thai"|translate}}</label>
                <div class="col-md-10">
                  <div class="md-radio-inline">
                    <div class="md-radio">
                      <input type="radio" id="state1" name="state" value="1" ng-model="data.state" class="md-radiobtn">
                      <label for="state1">
                        <span> </span>
                        <span class="check"> </span>
                        <span class="box"> </span>{{"trang_thai_hien_thi"|translate}}
                      </label>
                    </div>
                    <div class="md-radio">
                      <input type="radio" id="state2" name="state" value="0" ng-model="data.state" class="md-radiobtn">
                      <label for="state2">
                        <span> </span>
                        <span class="check"> </span>
                        <span class="box"> </span> {{"trang_thai_an"|translate}}
                      </label>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-md-12">
        <div ng-if="mode=='them'" ng-click="reset()" class="clear-form-data btn btn-sm btn-circle btn-danger">{{"xoa"|translate}}</div>
      </div>
    </form>
  </div>
</div>
<script>
  $(document).ready(function () {
    var scope = angular.element("#current-controller").scope();
    validator = myApp.validateForm("#form-tin-moi", {
      rules: {
        serviceId: {
          required: true
        },
        priority: {
          required: true,
          number: true,
          min: 0,
          digits: true
        },
        effectTime: {
          required: true
        },
        expiredTime: {
            required: true,
            expireDate_larger_effectDate: function () { return $('#effectTime input').val(); }
        },
        state: {
          required: true
        },
        adImgUrl: {
          required: true,
          maxlength: config.validate.length200,
          imageLink: true
        },
        id: {
          required: true
        },
        type: {
          required: true
        }
      },
      messages: {
        language: {
          required: validateMessages.ErrRequired
        },
        serviceId: {
          required: validateMessages.ErrRequired
        },
        type: {
          required: validateMessages.ErrRequired
        },
        priority: {
          required: validateMessages.ErrRequired,
          number: validateMessages.ErrNumber,
          digits: validateMessages.ErrIntNumber,
          min: validateMessages.ErrMinValue0
        },
        effectTime: {
          required: validateMessages.ErrEffectTimeReq
        },
        expiredTime: {
            required: validateMessages.ErrExpiredTimeReq,
            expireDate_larger_effectDate: validateMessages.expireDate_larger_effectDate
        },
        state: {
          required: validateMessages.ErrRequired
        },
        adImgUrl: {
          required: validateMessages.ErrRequired,
          imageLink: validateMessages.ErrImageLink
        },
        id: {
          required: validateMessages.ErrRequired,
        },
        type: {
          required: validateMessages.ErrRequired,
        }
      },
      submitHandler: function (form) {
        if ($(form).attr("mode") == 'them') {
          scope.add();
        }
        else if ($(form).attr("mode") == 'sua') {
          scope.update();
        }
      }
    });
  });
</script>
